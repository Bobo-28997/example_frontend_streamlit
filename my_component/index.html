<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Simple Component</title>
    <style>
        body { 
            font-family: sans-serif; 
            padding: 10px;
            background-color: #f0f2f6;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <h3>Hello <span id="name">World</span>!</h3>
        <p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç»„ä»¶</p>
        <button id="send-button">å‘é€æ¶ˆæ¯åˆ°Python</button>
        <div id="status" style="margin-top: 10px;"></div>
    </div>

    <!-- å°†è„šæœ¬ç§»åˆ°è¿™é‡Œï¼Œç¡®ä¿DOMå·²åŠ è½½ -->
    <script>
        // è‡ªå®šä¹‰ Streamlit å¯¹è±¡
        const Streamlit = {
            setComponentValue: function(value) {
                window.parent.postMessage({
                    type: "streamlit:setComponentValue",
                    value: value
                }, "*");
            },
            setComponentReady: function() {
                window.parent.postMessage({
                    type: "streamlit:componentReady",
                    apiVersion: 1
                }, "*");
            },
            setFrameHeight: function(height) {
                window.parent.postMessage({
                    type: "streamlit:setFrameHeight",
                    height: height
                }, "*");
            },
            RENDER_EVENT: "streamlit:render",
            events: {
                addEventListener: function(type, callback) {
                    window.addEventListener("message", function(event) {
                        // æ£€æŸ¥äº‹ä»¶ç±»å‹ï¼Œå¹¶ç›´æ¥å°† event.data ä¼ é€’ç»™å›è°ƒå‡½æ•°
                        if (event.data.type === type) {
                            callback(event.data); 
                        }
                    });
                }
            }
        };

        // --- ä¸šåŠ¡é€»è¾‘ ---

        function onRender(eventData) {
            // ğŸš€ å…³é”®ä¿®æ”¹ç‚¹ï¼šå›è°ƒå‡½æ•°ç›´æ¥æ¥æ”¶ eventDataï¼Œå¹¶ä»ä¸­è·å– args
            const args = eventData.args; 
            if (args && args.name) {
                document.getElementById("name").textContent = args.name;
            }
            // è®¾ç½®ç»„ä»¶é«˜åº¦
            Streamlit.setFrameHeight(150);
        }

        // ç›‘å¬æ¥è‡ª Python çš„æ¶ˆæ¯
        Streamlit.events.addEventListener(Streamlit.RENDER_EVENT, onRender);

        // æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        document.getElementById("send-button").addEventListener("click", function() {
            const message = "Hello from JavaScript! Time: " + new Date().toLocaleTimeString();
            document.getElementById("status").textContent = "å·²å‘é€: " + message;
            Streamlit.setComponentValue(message);
        });

        // å‘Šè¯‰ Python æˆ‘ä»¬å‡†å¤‡å¥½äº†
        Streamlit.setComponentReady();

    </script>
</body>
</html>
